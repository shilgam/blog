- type: parallel
  steps:
    - name: checkrb
      service: demo
      command: bundle exec ruby part1_check.rb
    - name: test
      service: demo
      command: sh -c "echo $TEST_TOKEN && bundle exec ruby part2_test.rb"
    - type: serial
      steps:
      - name: volumes_in
        service: demo
        command: bundle exec ruby part4.1_write.rb
      - name: volumes_out
        service: demo
        command: bundle exec ruby part4.2_read.rb

- type: serial
  steps:
    - name: dockerhub_push
      service: demo
      type: push
      image_name: shilgam/codeshipprointroguide
      encrypted_dockercfg_path: dockercfg.encrypted
